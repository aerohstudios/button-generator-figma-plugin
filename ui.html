<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/thomas-lowry/figma-plugin-ds/dist/figma-plugin-ds.css"
/>
<head>
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/thomas-lowry/figma-plugin-ds/dist/figma-plugin-ds.css"
  />
  <!-- Your other styles or scripts go here -->
</head>
<style>
  :root {
    --primary-color: #1e90ff;
    --secondary-color: #fd7e14;
    --background-color: #2c2c2c;
    --text-on-background-color: #ffffff;
  }
  * {
    margin: 0;
    padding: 0;
    font-family: "Inter";
    color: var(--figma-color-text);
  }
  body {
    padding: 30px;
    background-color: var(--figma-color-bg);
  }
  .section-title {
    font-size: 12px;
    font-weight: bold;
  }
  input {
    outline: none;
    background-color: transparent;
    border: 1px solid gray;
    padding: 0px;
    height: 30px;
    border-radius: 5px;
  }
  select {
    background-color: transparent;
    border: 1px solid gray;
    width: 100%;
    border-radius: 5px;
    padding: 5px;
  }
  .checkbox {
    display: flex;
    justify-content: flex-start;
    align-items: center;
    gap: 10px;
  }
  .checkbox__label {
    font-size: 12px;
  }
  .button--primary {
    background-color: #ffc83a;
    color: #100e14;
    padding: 10px;
    border-radius: 5px;
    font-size: 12px;
    border: none;
    height: 35px;
    width: 187px;
  }
  .button--secondary {
    background-color: transparent;
    /* color: #FFFFFF; */
    padding: 10px;
    border-radius: 5px;
    font-size: 12px;
    border: 1px solid var(--figma-color-border-strong);
    height: 40px;
    width: 187px;
  }
  input:checked {
    background-color: #ffc83a;
  }
</style>
<div style="display: flex; flex-direction: column; gap: 20px">
  <!-- /////////////// -->
  <div
    id="localStylesInputContainer"
    style="
      display: none;
      justify-content: center;
      flex-direction: column;
      align-items: center;
      gap: 2rem;
      width: 100%;
    "
  >
    <div
      id="localStylesInputContainer"
      style="
        display: flex;
        justify-content: center;
        flex-direction: row;
        align-items: center;
        gap: 2rem;
        width: 100%;
      "
    >
      <div
        style="
          display: flex;
          flex-direction: column;
          justify-content: center;
          align-items: flex-start;
          width: 100%;
          gap: 10px;
        "
      >
        <div class="section-title">Primary Color:</div>
        <!-- <div class="input" style="width: 100%;">
      <input
        type="number"
        id="button-height"
        class="input__field"
        placeholder="Button Height (max: 200)"
        max="200"
        min="0"
        style="width: 100%; padding: 5px"
      />
    </div> -->
        <select name="cars" id="color-dropdown">
          <option value="volvo">Volvo</option>
          <option value="saab">Saab</option>
          <option value="mercedes">Mercedes</option>
          <option value="audi">Audi</option>
        </select>
      </div>

      <div
        style="
          display: flex;
          flex-direction: column;
          justify-content: center;
          align-items: flex-start;
          width: 100%;
          gap: 10px;
        "
      >
        <div class="section-title">Secondary Color:</div>
        <!-- <div class="input" style="width: 100%;">
      <input
        type="number"
        id="button-width"
        class="input__field"
        placeholder="Button Width (max: 200)"
        min="0"
        max="200"
        style="width: 100%; padding: 5px"
      />
    </div> -->
        <select name="cars" id="secondary-color-dropdown">
          <option value="volvo">Volvo</option>
          <option value="saab">Saab</option>
          <option value="mercedes">Mercedes</option>
          <option value="audi">Audi</option>
        </select>
      </div>
    </div>
  </div>
  <!-- /////////////// -->
  <div
    id="customInputColorsSection"
    style="
      display: flex;
      justify-content: space-between;
      flex-direction: row;
      align-items: center;
      gap: 2rem;
    "
  >
    <div
      style="
        display: flex;
        justify-content: center;
        align-items: flex-start;
        width: 100%;
        flex-direction: column;
        gap: 10px;
      "
    >
      <div class="section-title">Primary Color:</div>
      <div class="input" style="width: 100%; height: 100%">
        <input
          type="color"
          id="primary-color"
          class="input__field"
          placeholder="Primary Color"
          value="#48479A"
          style="width: 100%; height: 30px"
        />
      </div>
    </div>

    <div
      style="
        display: flex;
        justify-content: center;
        align-items: flex-start;
        width: 100%;
        flex-direction: column;
        gap: 10px;
      "
    >
      <div class="section-title">Secondary Color:</div>
      <div style="width: 100%; height: 100%">
        <input
          type="color"
          id="secondary-color"
          class="input__field"
          placeholder="Secondary Color"
          value="#FFFFFF"
          style="width: 100%; height: 30px"
        />
      </div>
    </div>
  </div>

  <div class="checkbox" style="width: 100%">
    <input
      id="toggleLocalColorStylesCheckbox"
      type="checkbox"
      class="checkbox__box"
    />
    <label for="toggleLocalColorStylesCheckbox" class="checkbox__label"
      >Use Local Color Styles</label
    >
  </div>

  <hr style="border: 0.1px solid #7f7f7f; background-color: transparent" />

  <div
    style="
      display: flex;
      justify-content: flex-start;
      flex-direction: row;
      align-items: center;
      gap: 2rem;
    "
  >
    <div
      style="
        display: flex;
        justify-content: center;
        align-items: flex-start;
        width: 100%;
        flex-direction: column;
        gap: 10px;
      "
    >
      <div class="section-title">Button Radius:</div>
      <div class="input">
        <input
          type="number"
          id="button-radius"
          class="input__field"
          placeholder="Button Radius"
          style="padding: 5px; width: 100%"
        />
      </div>
    </div>

    <div
      style="
        display: flex;
        justify-content: center;
        align-items: flex-start;
        width: 100%;
        flex-direction: column;
        gap: 10px;
      "
    >
      <div class="section-title">Font Name:</div>
      <div class="input">
        <input
          type="text"
          id="font-style"
          class="input__field"
          placeholder="Font Name (ex: Arial)"
          style="padding: 5px; width: 100%"
        />
      </div>
    </div>
  </div>

  <!-- <hr style="border: 0.1px solid #7F7F7F; background-color: transparent;"/> -->

  <div class="checkbox" style="">
    <input id="toggleCheckbox" type="checkbox" class="checkbox__box" />
    <label for="toggleCheckbox" class="checkbox__label"
      >Custom height and width for buttons (Button Font Size will
      Auto-Scale)</label
    >
  </div>

  <div
    id="inputContainer"
    style="
      display: none;
      justify-content: center;
      flex-direction: column;
      align-items: center;
      gap: 2rem;
      width: 100%;
    "
  >
    <div
      id="inputContainer"
      style="
        display: flex;
        justify-content: center;
        flex-direction: row;
        align-items: center;
        gap: 2rem;
        width: 100%;
      "
    >
      <div
        style="
          display: flex;
          flex-direction: column;
          justify-content: center;
          align-items: flex-start;
          width: 100%;
          gap: 10px;
        "
      >
        <div class="section-title">Button Height:</div>
        <div class="input" style="width: 100%">
          <input
            type="number"
            id="button-height"
            class="input__field"
            placeholder="Button Height (max: 200)"
            max="200"
            min="0"
            style="width: 100%; padding: 5px"
          />
        </div>
      </div>

      <div
        style="
          display: flex;
          flex-direction: column;
          justify-content: center;
          align-items: flex-start;
          width: 100%;
          gap: 10px;
        "
      >
        <div class="section-title">Button Width:</div>
        <div class="input" style="width: 100%">
          <input
            type="number"
            id="button-width"
            class="input__field"
            placeholder="Button Width (max: 200)"
            min="0"
            max="200"
            style="width: 100%; padding: 5px"
          />
        </div>
      </div>
    </div>
  </div>

  <div class="checkbox" style="width: 100%">
    <input id="toggleTextSizeCheckbox" type="checkbox" class="checkbox__box" />
    <label for="toggleTextSizeCheckbox" class="checkbox__label"
      >Custom Button Font Size (will apply to ALL buttons)</label
    >
  </div>

  <div
    id="textSizeInputContainer"
    style="
      display: none;
      justify-content: center;
      flex-direction: column;
      align-items: center;
      gap: 2rem;
      width: 100%;
    "
  >
    <div
      style="
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: flex-start;
        width: 100%;
        gap: 10px;
      "
    >
      <div class="section-title">Button Font Size:</div>
      <div class="input" style="width: 100%">
        <input
          type="number"
          id="button-font-size"
          class="input__field"
          placeholder="Button Font Size"
          min="0"
          max="200"
          style="width: 100%; padding: 5px"
        />
      </div>
    </div>
  </div>

  <hr style="border: 0.1px solid #7f7f7f; background-color: transparent" />

  <div
    style="
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-direction: column;
      gap: 10px;
    "
  >
    <button id="submit-post" class="button button--primary">
      Generate Components
    </button>

    <p style="color: #7f7f7f; font-size: 12px">
      Have any issues or feedback, click on the button below
    </p>

    <a
      href="https://forms.gle/LrfpkoeQiALGzhai8"
      target="_blank"
      style="text-decoration: none"
      ><button class="button button--secondary" onclick="">
        Report / Give Feedback
      </button></a
    >
  </div>
</div>

<script>
  const inputContainer = document.getElementById("inputContainer");
  document.addEventListener("DOMContentLoaded", function () {
    const checkbox = document.getElementById("toggleCheckbox");

    checkbox.addEventListener("change", function () {
      inputContainer.style.display = checkbox.checked ? "flex" : "none";
    });
  });

  const inputFontSizeContainer = document.getElementById(
    "textSizeInputContainer"
  );
  document.addEventListener("DOMContentLoaded", function () {
    const checkbox = document.getElementById("toggleTextSizeCheckbox");

    checkbox.addEventListener("change", function () {
      inputFontSizeContainer.style.display = checkbox.checked ? "flex" : "none";
    });
  });

  // localStylesInputContainer
  const inputLocalColorStylesContainer = document.getElementById(
    "localStylesInputContainer"
  );
  const inputCustomStylesContainer = document.getElementById(
    "customInputColorsSection"
  );
  document.addEventListener("DOMContentLoaded", function () {
    const checkbox = document.getElementById("toggleLocalColorStylesCheckbox");

    checkbox.addEventListener("change", function () {
      inputLocalColorStylesContainer.style.display = checkbox.checked
        ? "flex"
        : "none";
      inputCustomStylesContainer.style.display = checkbox.checked
        ? "none"
        : "flex";
    });
  });
  document.getElementById("submit-post").onclick = () => {
    const primaryColor = document.getElementById("primary-color").value;
    const secondaryColor = document.getElementById("secondary-color").value;
    const buttonRadius = document.getElementById("button-radius").value;
    const fontStyle = document.getElementById("font-style").value;
    const buttonHeight = document.getElementById("button-height").value;
    const buttonWidth = document.getElementById("button-width").value;
    const buttonFontSize = document.getElementById("button-font-size").value;
    const useCustomSize = document.getElementById("toggleCheckbox").checked;
    const useCustomFontSize = document.getElementById(
      "toggleTextSizeCheckbox"
    ).checked;

    if (useCustomSize) {
      // Validate custom height and width
      const isValidHeight = validateSize(buttonHeight);
      const isValidWidth = validateSize(buttonWidth);

      if (!isValidHeight || !isValidWidth) {
        alert(
          "Custom height and width should be numbers less than or equal to 200."
        );
        return;
      }
    }
    console.log("Submit ");
    console.log(useCustomSize);
    // console.log(primaryColor, secondaryColor, buttonRadius, fontStyle)
    const primaryrgbValues = hexToSmallRgb(primaryColor);
    const secondaryrgbValues = hexToSmallRgb(secondaryColor);
    function hexToSmallRgb(hex) {
      // Remove the hash character, if present
      hex = hex.replace(/^#/, "");

      // Parse the hex values to RGB
      var bigint = parseInt(hex, 16);
      var r = ((bigint >> 16) & 255) / 255;
      var g = ((bigint >> 8) & 255) / 255;
      var b = (bigint & 255) / 255;

      // Return the small RGB values as an object
      return { r: r, g: g, b: b };
    }

    parent.postMessage(
      {
        pluginMessage: {
          primaryrgbValues,
          secondaryrgbValues,
          buttonRadius,
          fontStyle,
          buttonHeight,
          buttonWidth,
          buttonFontSize,
          useCustomSize,
          useCustomFontSize,
        },
      },
      "*"
    );
  };
  function validateSize(value) {
    const numericValue = parseFloat(value);
    return !isNaN(numericValue) && numericValue <= 200;
  }

  onmessage = (event) => {
    const message = event.data.pluginMessage;
    console.log(message, "message");

    if (message.type === "setDropdownOptions") {
      const dropdown = document.getElementById("color-dropdown");
      const dropdownSecondary = document.getElementById(
        "secondary-color-dropdown"
      );
      dropdown.innerHTML = ""; // Clear existing options
      dropdownSecondary.innerHTML = ""; // Clear existing options

      message.options.forEach((option) => {
        const optionElement = document.createElement("option");
        optionElement.value = option.value;
        optionElement.text = option.label;
        dropdown.appendChild(optionElement);
        // dropdownSecondary.appendChild(optionElement);
      });
      message.options.forEach((option) => {
        const optionElement = document.createElement("option");
        optionElement.value = option.value;
        optionElement.text = option.label;
        // dropdown.appendChild(optionElement);
        dropdownSecondary.appendChild(optionElement);
      });
    }
  };
</script>
